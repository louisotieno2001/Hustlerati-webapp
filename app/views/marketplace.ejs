<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marketplace | Hustlerati</title>
    <link rel="icon" href="/images/logo1.png" type="image/x-icon">
    <link rel="stylesheet" href="/styles/small-devices.css">
    <link rel="stylesheet" href="/styles/index.css">
    <link rel="stylesheet" href="/styles/marketplace.css">
    <link rel="stylesheet" href="/styles/loader.css">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-VCMHYS7QJ4');
    </script>
</head>

<body>
    <div class="top-menu" id="top-menu">
        <img src="/images/logo1.png" alt="Logo Image" style="height: 60px; width: 60px;">
        <div class="menu-icons">
            <span class="material-symbols-outlined" id="cart">
                shopping_cart
                <p id="cart-numbers" class="cart-numbers">
                    <%= totalQuantity %>
                </p>
            </span>

            <span class="material-symbols-outlined" id="open-menu">menu</span>
            <span class="material-symbols-outlined" id="close-menu">close</span>
        </div>
        <div class="sub-menu" id="sub-menu">
            <div class="link-item"><span class="material-symbols-outlined">grid_view</span><a href="/home">Dashboard</a>
            </div>
            <div class="link-item"><span class="material-symbols-outlined">local_convenience_store</span><a
                    href="/home">Marketplace</a></div>
            <div class="link-item"><span class="material-symbols-outlined">monitoring</span><a href="/home">Investor
                    Insights</a></div>
            <div class="link-item"><span class="material-symbols-outlined">newspaper</span><a href="/home">News Feed</a>
            </div>
            <div class="link-item"><span class="material-symbols-outlined">account_circle</span><a
                    href="/home">Profile</a></div>
            <div class="link-item"><span class="material-symbols-outlined">gavel</span><a href="#" id="terms">Terms of
                    Service</a></div>
        </div>
    </div>
    <div class="market-display">
        <div class="carousel">
            <div class="carousel-inner" id="carousel-inner">
                <img src="/images/black-air-force.jpeg" alt="Slide 1" class="active">
                <img src="/images/blue-and-white-air-jordans.jpeg" alt="Slide 2">
                <img src="/images/top-short1.jpeg" alt="Slide 3">
            </div>
            <button class="carousel-control prev" id="prevBtn">&#10094;</button>
            <button class="carousel-control next" id="nextBtn">&#10095;</button>
        </div>
        <div class="filter-container">
            <div class="filter-input">
                <span class="material-symbols-outlined" title="Filter">tune</span>
                <input type="text" id="filter-theme" class="filter-theme"
                    placeholder="Filter e.g fashion, food, software">
                <span class="material-symbols-outlined" id="filter">outbound</span>
            </div>
        </div>
        <div class="product-list" id="product-list">
            <% if (products && products.length> 0) { %>
                <% // Group products by business_niche %>
                    <% const categories={}; %>
                        <% products.forEach(item=> { %>
                            <% if (!categories[item.business_niche]) { %>
                                <% categories[item.business_niche]=[]; %>
                                    <% } %>
                                        <% categories[item.business_niche].push(item); %>
                                            <% }); %>

                                                <% for (const niche in categories) { %>
                                                    <section class="category-section">
                                                        <h2>
                                                            <%= niche %>
                                                        </h2>
                                                        <div class="divider"></div>
                                                        <div class="product-cards">
                                                            <% categories[niche].forEach(product=> { %>
                                                                <div class="product-card">
                                                                    <div class="product-image"
                                                                        style="background-image: url('/uploads/<%= product.item_image %>');">
                                                                    </div>
                                                                    <div class="product-info">
                                                                        <h3>
                                                                            <%= product.item_name %>
                                                                        </h3>
                                                                        <p>
                                                                            <%= product.item_description %>
                                                                        </p>
                                                                        <p style="display: flex;flex-direction: row; justify-content: start; align-items: center;">
                                                                            <span class="material-symbols-outlined" style="color: yellow;">
                                                                                universal_currency
                                                                                </span>@<%= product.item_price %>
                                                                           
                                                                       
                                                                        </p>
                                                                        <p style="display: flex;flex-direction: row; justify-content: start; align-items: center;"><span class="material-symbols-outlined" style="color: yellow;">
                                                                            info
                                                                            </span> <%= product.item_quantity %> Units left
                                                                        </p>
                                                                        <p style="display: flex;flex-direction: row; justify-content: start; align-items: center;"><span class="material-symbols-outlined" style="color: yellow;">
                                                                            check_circle
                                                                            </span><%= product.item_condition %>
                                                                        <div class="add-to-cart">
                                                                            <button class="add-to-cart-button"
                                                                                data-product-id="<%= product.id %>"
                                                                                data-product-name="<%= product.item_name %>"
                                                                                data-seller-id="<%= product.user_id %>"
                                                                                data-item-quantity="<%= product.item_quantity %>"
                                                                                data-product-image="<%= product.item_image %>"
                                                                                data-unit-price="<%= product.item_price %>">
                                                                                <span class="material-symbols-outlined"
                                                                                    id="cart">
                                                                                    shopping_cart
                                                                                </span>Add to cart</button>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <% }); %>
                                                        </div>
                                                    </section>
                                                    <% } %>
                                                        <% } else { %>
                                                            <p>No products available in this marketplace.</p>
                                                            <% } %>
        </div>
    </div>
    <div class="feedback-div" id="feedback-div">
        <p class="feedback" id="error"></p>
        <p class="feedback" id="success"></p>
    </div>
    <div class="loader" id="loader">
        <div class="spinner"></div>
    </div>
    <script src="/scripts/marketPlaceLogic.js"></script>
    <script src="/scripts/filterCategory.js"></script>
</body>

</html>