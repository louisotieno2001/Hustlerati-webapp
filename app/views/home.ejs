<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hustlerati</title>
    <link rel="icon" href="/images/logo1.png" type="image/x-icon">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="/styles/small-devices.css">
    <link rel="stylesheet" href="/styles/index.css">
    <link rel="stylesheet" href="/styles/home.css">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,1,0" />
</head>
<body>
    <div class="tabs-container">
        <div class="top-bar">
        </div>
        <div class="menu" id="menu">
            <div class="menu-icon" id="menu-icon" title="Menu Icon">&#9776;</div>
            <span class="material-symbols-outlined" title="logout" id="logout">logout</span>
        </div>

        <div class="tab" id="menu-tab">
            <div class="menu-items" id="menu-items">
                <img src="/images/logo1.png" alt="Logo Image" srcset="" style="height: 60px; width: 60px;">
                <a href="#dashboard" class="menu-link" title="Dashboard"><span
                        class="material-symbols-outlined">grid_view</span>Dashboard</a>
                <a href="#shop" class="menu-link" title="Marketplace"><span
                        class="material-symbols-outlined">local_convenience_store</span>Marketplace</a>
                <a href="#investing" class="menu-link" title="Investor Insights"><span
                        class="material-symbols-outlined">monitoring</span>Investor Insights</a>
                <a href="#news" class="menu-link" title="News feed"><span
                        class="material-symbols-outlined">newspaper</span>Hustlerati Feed</a>
                <a href="#profile" class="menu-link" title="Profile"><span
                        class="material-symbols-outlined">account_circle</span>Profile</a>
                <a href="/loans/page" class="loans" title="Loans"> <span class="material-symbols-outlined">
                    paid
                    </span>Hustlerati loans</a>
            </div>
        </div>
        <div class="middle-tab" id="middle-tab">
            <div class="display" id="dashboard">
                <img src="/images/logo1.png" alt="" srcset="" style="height: 160px; width: 160px; " id="home-logo" />
                <h1>Welcome to Hustlerati business Suite</h1>
                <% if (userData && userData.business_name) { %>
                    <button class="button-87" role="button" id="businessBtn"
                        style="display: none;"><strong>+</strong>Add your business</button>
                    <button class="button-87" role="button" id="mindBtn"><strong>+</strong>Mind <%=
                            userData.business_name %></button>
                    <% } else { %>
                        <button class="button-87" role="button" id="businessBtn"><strong>+</strong>Add your
                            business</button>
                        <button class="button-87" role="button" id="mindBtn"
                            style="display: none;"><strong>+</strong>Mind <%= userData.business_name %></button>
                        <% } %>

            </div>
            <div class="display push active-tab" id="shop">
                <div id="ads-container" class="">
                    <% function truncateText(text, maxLength) {
                        if (!text) return ''; // Return empty string if text is null or undefined
                        if (text.length > maxLength) {
                            return text.substring(0, maxLength) + '...';
                        }
                        return text;
                    } %>
                    <% ads.forEach((ad, index) => { %>
                        <% if (ad.post_pic !== null && ad.post_title !== null && ad.post_body !== null) { %>
                            <div class="product-card" id="card-<%= index %>" style="background-image: url('/uploads/<%= ad.post_image %>');">
                                <div class="post-data">
                                    <div class="more-items" id="more-items-<%= index %>">
                                        <p>See more products</p>
                                        <span class="material-symbols-outlined">arrow_circle_right</span>
                                    </div>
                                    <div class="text"> 
                                        <strong><p id="title-<%= index %>"><%= ad.post_title %></p></strong> 
                                        <p id="body-<%= index %>"><%= truncateText(ad.post_body, 250) %> <a href="#" class="read-more" data-post-body="<%= ad.post_body %>">Read more</a></p>
                                    </div>
                                </div>
                            </div>
                        <% } %>
                    <% }); %>
                </div>
            </div>            
            <div class="display" id="investing">
                <div class="insights-card" id="insights-card">
                    <% if (blogs.length === 0) { %>
                        <p id="no-posts">No post available yet. Great things are coming!</p>
                    <% } else { %>
                        <% blogs.forEach((blog, index) => { %>
                            <% if (blog.post_image !== null && blog.post_title !== null && blog.post_body !== null) { %>
                                <div class="card" id="card-<%= index %>" style="background-image: url('https://127.0.0.1:8055/assets/<%= blog.post_image %>');" data-title="<%= blog.post_title %>" data-body="<%- blog.post_body %>" data-image="/uploads/<%= blog.post_image %>">
                                    <div class="text"> 
                                        <h1 id="title-<%= index %>"><%= blog.post_title %></h1>
                                        <p id="body-<%= index %>"><%- truncateText(blog.post_body, 200) %> <a href="#" class="read-more" data-post-body="<%- blog.post_body %>">Read more</a></p>
                                    </div>
                                </div>
                            <% } %>
                        <% }); %>
                    <% } %>
                </div>
            </div>            
            <div class="display" id="news">
                <div class="news-card" id="news-card">
                    <% if (news.length === 0) { %>
                        <p>No news available. Post something!</p>
                    <% } else { %>
                        <% news.forEach(ad => { %>
                            <% if (ad.post_pic !== null && ad.post_title !== null && ad.post_body !== null) { %>
                                <div class="card" style="background-image: url('/uploads/<%= ad.post_image %>');" data-title="<%= ad.post_title %>" data-body="<%- ad.post_body %>" data-image="/uploads/<%= ad.post_image %>">
                                    <div class="text"> 
                                        <h1><%= ad.post_title %></h1>
                                        <p><%= truncateText(ad.post_body, 200) %> <a href="#" class="read-more" data-post-body="<%= ad.post_body %>">Read more</a></p>
                                    </div>
                                </div>
                            <% } %>
                        <% }); %>
                    <% } %>
                </div>     
                <div class="add" id="add"><span class="material-symbols-outlined">edit</span></div>
            </div>            
            <div class="display" id="profile">
                <h1>Profile</h1>
                <div class="profile-card">
                    <div class="profile-pic" id="profile-pic"
                        style="background-image: url('/uploads/<%= userData.profile_pic %>');"></div>
                    <input type="file" id="fileInput" accept="image/*" capture style="display:none;" name="picture"
                        enctype="multipart/form-data">
                    <div class="preview" id="preview">
                        <button class="button" id="edit-pic">Submit</button>
                    </div>
                    <div class="personal-info">
                        <div class="user-data">
                            <span class="material-symbols-outlined">
                                account_circle
                            </span>
                            <h4>
                                <%= userData.firstname %>
                            </h4>
                        </div>
                        <div class="user-data">
                            <span class="material-symbols-outlined">
                                account_circle
                            </span>
                            <h4>
                                <%= userData.lastname %>
                            </h4>
                        </div>
                        <div class="user-data">
                            <span class="material-symbols-outlined">
                                mail
                            </span>
                            <h4>
                                <%= userData.email %>
                            </h4>
                        </div>
                        <div class="user-data">
                            <span class="material-symbols-outlined">
                                phone_enabled
                            </span>
                            <h4>
                                <%= userData.phone %>
                            </h4>
                        </div>

                        <button class="button-87" id="edit-profile">Edit profile</button>
                        <dialog class="dialog" id="edit-profile-dialog">
                            <h2 style="color: aliceblue; text-align: center;">Edit Profile</h2>
                            <div class="input-div">
                                <span class="material-symbols-outlined">
                                    account_circle
                                </span>
                                <input type="text" id="fname" name="fname" required placeholder="John">
                            </div>
                            <div class="input-div">
                                <span class="material-symbols-outlined">
                                    account_circle
                                </span>
                                <input type="text" id="lname" name="lname" required placeholder="Doe">
                            </div>
                            <div class="input-div">
                                <span class="material-symbols-outlined">
                                    phone_enabled
                                </span>
                                <input type="tel" name="phone" id="phone" placeholder="Phone" required>
                            </div>
                            <button class="button-87" id="profile-edit-submit">Edit profile</button>
                        </dialog>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="tab" id="ads-tab">
        <div class="carousel-container">
            <div class="carousel-wrapper">
                <div class="carousel-item">
                    <img src="/images/logo1.png" alt="Image 1">
                </div>
                <div class="carousel-item">
                    <img src="/images/logo1.png" alt="Image 2">
                </div>
                <div class="carousel-item">
                    <img src="/images/logo1.png" alt="Image 3">
                </div>
            </div>
            <span class="material-icons" id="prevBtn" onclick="prevSlide()">navigate_before</span>
            <span class="material-icons" id="nextBtn" onclick="nextSlide()">navigate_next</span>
        </div>
    </div>
    <dialog id="more">
        <p id="content"></p>
        <a href="#" id="exit">Exit</button>
    </dialog>
    <dialog id="post-dialog">
        <button class="button-87 posting" id="pick-image">Pick image</button>
        <input type="file" id="fileInput" accept="image/*" capture style="display:none;" name="picture"
            enctype="multipart/form-data">
        <div class="preview" id="add-preview">

        </div>
        <div class="input-div">
            <span class="material-symbols-outlined">
                title
            </span>
            <input type="text" id="title" name="title" required placeholder="Title">
        </div>
        <div class="body-div">
            <span class="material-symbols-outlined">
                list_alt
            </span>
            <textarea name="body" id="body" cols="30" rows="10"
                placeholder="What do you wan to say..."></textarea>
        </div>
        <button class="button-87 posting" id="post-submit">Submit</button>
        <button class="button-87 posting" id="exit-post">Exit</button>
    </dialog>
   <script src="/scripts/homeFunctionalities.js"></script>
    <script src="/scripts/readBlog.js"></script>
</body>
</html>